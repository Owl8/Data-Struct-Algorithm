ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ 2015å¹´11æœˆ27æ—¥ 20æ™‚26åˆ†06ç§’
 ã«é–‹å§‹ã—ã¾ã—ãŸ]0;owl@owlinux220: ~/prog/algorithm/ringbufferowl@owlinux220:~/prog/algorithm/ringbuffer$ cat ringbuffer.c 
#include <stdio.h>

#define DataNum (6)

typedef struct {
	int data[DataNum];
	int top;
	int tail;
} ringbuffer;

void init(ringbuffer*);
void enqueue(ringbuffer*, int);
int dequeue(ringbuffer*);
void printRingBuffer(ringbuffer*);

int main(void) {
	ringbuffer rb;
	char cmd;
	init(&rb);
	puts("Input i, d, p or q.");
	for (cmd = 0; cmd != 'q'; ) {
		int enqueueData;
		do {
			cmd = getchar();
		} while(cmd == '\n');
		switch(cmd) {
		case 'i':
			scanf("%d", &enqueueData);
			enqueue(&rb, enqueueData);
			break;
		case 'd':
			dequeue(&rb);
			break;
		case 'p':
			printRingBuffer(&rb);
			break;
		case 'q':
			break;
		default:
			puts("Input i, d, p or q.");
		}
	}
	return 0;		
}

void init(ringbuffer* rb) {
	int i;
	for (i = 0; i < DataNum; ++i) {
		rb->data[i] = 0;
	}
	rb->top = rb->tail = 0;
}

void enqueue(ringbuffer* rb, int num) {
	if (rb->top == (rb->tail + 1) % DataNum) {
		puts("Queue is filled.");
		return;
	}
	rb->data[rb->tail] = num;
	rb->tail = ++(rb->tail) % DataNum;
}

int dequeue(ringbuffer *rb) {
	int ret = rb->data[rb->top];
	if (rb->top % DataNum == rb->tail) {
		puts("Queue is empty.");
		return;
	}
	rb->data[(rb->top)++] = 0;
	rb->top %= DataNum;
	return ret;
}

void printRingBuffer(ringbuffer* rb) {
	int i;
	for (i = rb->top; i != rb->tail; i = ++i % DataNum) {
		printf("%d ", rb->data[i]);
	}
	putchar('\n');
}

]0;owl@owlinux220: ~/prog/algorithm/ringbufferowl@owlinux220:~/prog/algorithm/ringbuffer$ gcc ringbuffer.c 
]0;owl@owlinux220: ~/prog/algorithm/ringbufferowl@owlinux220:~/prog/algorithm/ringbuffer$ /[K./a.out 
Input i, d, p or q.
p

i1
p
1 
i2
p
1 2 
i3
p
1 2 3 
i4
p
1 2 3 4 
i5
p
1 2 3 4 5 
i6
Queue is filled.
p
1 2 3 4 5 
d
i6
p
2 3 4 5 6 
i d
i7
p
3 4 5 6 7 
d
d
p
5 6 7 
i
8
p
5 6 7 8 
d
p
6 7 8 
dp
7 8 
dp
8 
dp

dp
Queue is empty.

q
]0;owl@owlinux220: ~/prog/algorithm/ringbufferowl@owlinux220:~/prog/algorithm/ringbuffer$ exit
exit

ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ 2015å¹´11æœˆ27æ—¥ 20æ™‚27åˆ†18ç§’
 ã«çµ‚äº†ã—ã¾ã—ãŸ
